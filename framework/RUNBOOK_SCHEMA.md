# RUNBOOK_SCHEMA.md

## Purpose

This schema defines the standard structure for per-feature runbooks.
Runbooks are execution aids, not sources of truth.

They provide a copy/paste-friendly sequence of agent prompts for a single feature.

The authoritative state remains in:
- FEATURES.md
- STATUS.md
- ADRs
- Architecture artefacts

---

## Runbook Metadata

- Feature ID: <e.g. F-003>
- Feature Name: <short descriptive name>
- Agent Path: <e.g. Coder → Reviewer → Tester>
- Generated By: Planner
- Date Generated: <YYYY-MM-DD>

---

## Preconditions

List conditions that must be true before execution:
- Feature status is `todo`
- Required artefacts exist (PRD, ADRs if applicable)
- Architecture decisions are complete (if required)

---

## Execution Steps

Each step must be executed in order.

---

### Step 1 — CODER

Prompt (copy/paste):

You are CODER.
Follow `framework/agents/CODER.md`.
Implement Feature <Feature ID> from FEATURES.md.
Update status `todo → doing` only.
Provide an implementation summary.

---

### Step 2 — REVIEWER

Prompt (copy/paste):

You are REVIEWER.
Follow `framework/agents/REVIEWER.md`.
Review Feature <Feature ID>.
Approve or reject the implementation.
Do not update feature status.

---

### Step 3 — SECURITY REVIEWER (conditional)

Trigger:
<Describe why security review is required>

Prompt (copy/paste):

You are SECURITY_REVIEWER.
Follow `framework/agents/SECURITY_REVIEWER.md`.
Perform a security and threat assessment for Feature <Feature ID>.
Produce a security review artefact following SECURITY_REVIEW_SCHEMA.md.

---

### Step 4 — TESTER

Prompt (copy/paste):

You are TESTER.
Follow `framework/agents/TESTER.md`.
Validate Feature <Feature ID>.
Update status `doing → done` only after successful validation.
Produce a test report if required.

---

### Step 5 — DOCS (conditional)

Trigger:
<User-facing change, documentation update required>

Prompt (copy/paste):

You are DOCS.
Follow `framework/agents/DOCS.md`.
Update documentation based on completed Feature <Feature ID>.

---

## Completion Criteria

The runbook is complete when:
- Feature status is `done`
- Required artefacts are updated
- No open review or test findings remain

---

## Notes

- Runbooks may be regenerated at any time.
- Deviations from this runbook must be justified and documented.
